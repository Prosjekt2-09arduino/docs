\chapter{Testing}
	This chapter contains a description of the testing performed during the project. Tests were performed in order to ensure product quality and that the product meets the requirements set. 
	
	\section{Testing strategy}
		The ways in which testing was performed is detailed in this section. Testing was performed by unit testing first, then integration testing. Usability testing was performed after the main shop part of the project was completed. User acceptance testing was then performed by the customer after significant parts were complete.

		\subsection{Unit testing}
			For testing of the Android application, Robotium was used. Robotium is a powerful test framework that can be used for function, system and acceptance testing. The tests created in Robotium aims at writing small portions of code and checking the results against expected predefined values. Robotium was used for unit testing on the Android application. During the development of the application, different units were tested with Robotium after they were finished. An example of a Robotium test is shown below. In this test it is asserted that the Bluetooth connection with a Arduino device is as expected. \\

			\begin{lstlisting}
solo.clickOnActionBarItem(R.id.settings);

ConnectionState expectedState = BluetoothConnection
	.ConnectionState.STATE_CONNECTED;
	
ConnectionState actualState = BtArduinoService.getBtService()
	.getBluetoothConnection().getConnectionState();

assertEquals(expectedState, actualState);
			\end{lstlisting}

		\subsection{Integration testing}
			Integration testing is based on combining different units and testing the interface and communication between them. It is a phase after the unit testing and before the validation testing. The units that can be used in these tests must therefore have passed the unit tests. Because our system is composed of more than one process (stk500 protocol and the market application), they were tested in pairs and not all at once. Integration testing identifies problems that occur when we combine the different units of the product. A persistent Bluetooth connection through the whole application was tested by checking if the service was providing a STATE\_CONNECTED at all times when we expected it to be connected. When the application was closed and reopened or if the phone was rebooted it should hold its state if possible (if the Arduino was turned on and in range). 


		\subsection{Usability test}
		As the intent of the product was to ease the use of and set up physical user interfaces, usability tests were crucial in the testing aspects. The decision were made to perform a hallway test following tasks given to the test subjects. To ensure proper understanding of the test subject, the think aloud protocol was used, meaning the subject talked about their actions during the test. 

		All test subjects filled out a System Usability Scale form in order to create a score, 0-100, which gave us a comparable score with other systems. Concerning the amount of subjects tested, five users has been recognised as the proper amount. According to \cite{Nielsen}, 85\% of the problems with a system will be found by these five users, thus testing more would increase the time spent watching the same problems resurface.

		\subsubsection{Tasks}
		These were the tasks given to each tester. The tasks were created with the user cases previously mentioned as a basis. Each task is meant to be a vague description of what they are supposed to do in order for them having to think mostly for themselves and not given any answer as to what they are supposed to do. 

		The preface of these tasks were that they had bought a jacket with an Arduino device fitted in it. This jacket was called an iJacket and they had just downloaded the $\mu$CSS in order for them to check what other applications they could have on this jacket.

		\begin{enumerate}
		 \item Select your jacket
		 \item Look for applications
		 \item Filtrate the applications which doesn't work on your jacket
		 \item Install the application
		\end{enumerate}

		After the tests the test subjects were asked if there were any details or points during the test where they either were confused or found it difficult to do something. These points would be added or confirmed on a form where the observer would have noted any other details which may have risen during the test.


		\subsection{User acceptance testing}
			User acceptance testing was done by the customer in order to ensure that requirements were met and whether the customer had any improvement points or not. There were also expert reviews made during a presentation at the offices of SINTEF. The think aloud protocol was also used here.


	\section{System Testing}
	In this section the system tests will be presented. Each test was written to test a specific part of the product, and applies to both the Android application, STK500 protocol and software installed on the Arduino device. Each test was executed separately, and the results will be presented in section \ref{testresults}.

	\begin{table}[H]
	\caption{Connect with device using device list}
	\begin{tabularx}\linewidth{|m{0.15 \textwidth}|X|}
		\hline
			{Test ID} & {ST01}\\
		\hline
			Test name & Device list connect\\
		\hline
			Test description & Connect with an Arduino device from the Device list screen \\
		\hline
			Precondition & Arduino device is switched on with Bluetooth \\ 
		\hline
			Test steps & \begin{itemize}
				\item{Start program}
				\item{Press Device list from Action overflow}
				\item{Press desired Arduino device}
				\end{itemize} \\
		\hline
			Success condition & Android and Arduino device is connected via Bluetooth \\
		\hline
	\end{tabularx}
	\end{table}

	\begin{table}[H]
	\caption{Connect with device using QR code}
	\begin{tabularx}\linewidth{|m{0.15 \textwidth}|X|}
		\hline
			{Test ID} & {ST02}\\
		\hline
			Test name & QR code connect\\
		\hline
			Test description & Connect with an Arduino device using QR code reader \\
		\hline
			Precondition & Arduino device is switched on with Bluetooth \\ 
		\hline
			Test steps & \begin{itemize}
				\item{Start program}
				\item{Press Device list from Action overflow}
				\item{Press Add device}
				\item{Press Connect with QR code}
				\item{Choose QR code reader}
				\item{Scan QR code}
				\end{itemize} \\
		\hline
			Success condition & Android and Arduino device is connected via Bluetooth \\
		\hline
	\end{tabularx}
	\end{table}

	\begin{table}[H]
	\caption{Connect with device using serial}
	\begin{tabularx}\linewidth{|m{0.15 \textwidth}|X|}
		\hline
			{Test ID} & {ST03}\\
		\hline
			Test name & Input serial connect \\
		\hline
			Test description & Connect with an Arduino device using serial \\
		\hline
			Precondition & Arduino device is switched on with Bluetooth \\ 
		\hline
			Test steps & \begin{itemize}
				\item{Start program}
				\item{Press Device list from Action overflow}
				\item{Press Add device}
				\item{Press Connect with QR code}
				\item{Choose QR code reader}
				\item{Scan QR code}
				\end{itemize} \\
		\hline
			Success condition & Android and Arduino device is connected via Bluetooth \\
		\hline
	\end{tabularx}
	\end{table}

	\begin{table}[H]
	\caption{Search for desired app}
	\begin{tabularx}\linewidth{|m{0.15 \textwidth}|X|}
		\hline
			{Test ID} & {ST04}\\
		\hline
			Test name & Search \\
		\hline
			Test description & Search for a specific app \\
		\hline
			Precondition & Database is populated \\ 
		\hline
			Test steps & \begin{itemize}
				\item{Start program}
				\item{Press search icon}
				\item{Type search string}
				\end{itemize} \\
		\hline
			Search result is shown with matching apps \\
		\hline
	\end{tabularx}
	\end{table}

	\begin{table}[H]
	\caption{Connect to last connected device when in range}
	\begin{tabularx}\linewidth{|m{0.15 \textwidth}|X|}
		\hline
			{Test ID} & {ST05}\\
		\hline
			Test name & Last connected\\
		\hline
			Test description & Test that the Android application connects to the last connected Arduino device when it is in range and gives proper feedback \\
		\hline
			Precondition & Available Arudino device with Bluetooth \\ 
		\hline
			Test steps & \begin{itemize}
				\item{Connect with an Arduino}
				\item{Exit Android application completely}
				\item{Start Android application}
					\begin{itemize}
						\item{When the Arduino device is in range}
						\item{When the Arduino device is out of range/off}
					\end{itemize}
				\end{itemize} \\
		\hline
			Success condition & When the last connected Arudino device is on and in range, the Android device should connect to it immediately when the Android application is started and give feedback to the user. If the Arduino device is out of range or off, proper feedback should be given \\
		\hline
	\end{tabularx}
	\end{table}

	\begin{table}[H]
	\caption{Browse apps test}
	\begin{tabularx}\linewidth{|m{0.15 \textwidth}|X|}
		\hline
			Test ID & ST06\\
		\hline
			Test name & Browse apps\\
		\hline
			Test description & Browse apps in the Android application in a random fashion \\
		\hline
			Precondition & Database is populated \\ 
		\hline
			Test steps & \begin{itemize}
				\item{Start program}
				\item{Choose a category}
				\item{Choose an app}
				\item{Go back and choose different app}
				\item{Swipe left/right to browse different sorting}
				\end{itemize} \\
		\hline
			Success condition & User is able to browse apps \\
		\hline
	\end{tabularx}
	\end{table}

	\begin{table}[H]
	\caption{Install application on Arduino device}
	\begin{tabularx}\linewidth{|m{0.15 \textwidth}|X|}
		\hline
			{Test ID} & {ST07}\\
		\hline
			Test name & Install application on Arduino device\\
		\hline
			Test description & Choose a desired application to install on a connected Arduino device \\
		\hline
			Precondition & Android and Arduino device is connected via Bluetooth \\ 
		\hline
			Test steps & \begin{itemize}
				\item{Start program}
				\item{Select desired app}
				\item{Press Install}
				\item{Press Confirm}
				\end{itemize} \\
		\hline
			Success condition & Arduino app is installed on the connected Arduino device \\
		\hline
	\end{tabularx}
	\end{table}

	\begin{table}[H]
	\caption{Change connected device}
	\begin{tabularx}\linewidth{|m{0.15 \textwidth}|X|}
		\hline
			{Test ID} & {ST08}\\
		\hline
			Test name & Change connected device\\
		\hline
			Test description & Test that it is possible to first connect to one Arduino, then another, thus changing which device the Android application is connected to \\
		\hline
			Precondition & Two available Arduinos with Bluetooth\\ 
		\hline
			Test steps & \begin{itemize}
				\item{Start program}
				\item{Connect with Arduino \#1}
				\item{Connect with Arduino \#2}
				\end{itemize} \\
		\hline
			Success condition & Both connections is successful, and the Android device is connected with Arduino \#2 \\
		\hline
	\end{tabularx}
	\end{table}

	\section{Test Results}
	\label{testresults}
		In this section the results of all the tests performed will be presented. In each subsection the result of the given type of test will be shown.

		Table ~\ref{table:testresults} shows the test results of the Robotium Unit tests

		\begin{table}[H]
		\caption{Test Results}
		\label{table:testresults}
		\begin{tabularx}\linewidth{|m{0.15 \textwidth}|m{0.15 \textwidth}|X|}
			\hline
				{\bf Requirement code} & {\bf Result} & {\bf Comment}\\
			\hline
				FR01 & PENDING & This cannot be tested before the protocol is complete\\
			\hline
				FR02 & PASS & Usability testing was performed on SINTEF workshop\\
			\hline
				FR03 & PASS & \\
			\hline
				FR04 & PASS & This is possible unless you uninstall and install the application\\
			\hline
				FR05 & ERROR & There was no time to implement a standard for device compatibility validation\\
			\hline
				FR06 & PASS & The user can choose from a list a QR reader to use. The serialInput is a mac address\\
			\hline
		\end{tabularx}
		\end{table}

		\subsection{Unit Testing}
		All written Robotium tests run without encoutering errors. This indicates that the units tested works properly and correct values are obtained throughout the testing. A decision was made to not write any more tests as time was of an essence and resources were needed elsewhere. 

		\subsection{Integration Testing}

		\subsection{Usability Testing}

		\subsection{User Acceptance Testing}
		What the customer thought 
